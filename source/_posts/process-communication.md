---
title: process_communication
date: 2016-04-21 10:25:01
tags: 进程间的通信方式总结
---
+ 管道：（管道分为命名管道和非命名管道），非命名管道只能用于父子进程通讯，命名管道可用于非父子进程，命名管道就是FIFO,管道是单向的，先进先出的，无结构的，固定大小的字节流，它把一个进程的标准输出和另一个进程的标准输入连接在一起。写进程在管道的尾端写入数据，读进程在管道的头端读出数据，数据读数据后将管道中移走，其他读进程就不能再读这些数据。管道提供简单的流控制机制，进程试图读空管道时，在有数据写入管道前一直阻塞，同样，管道已经满时进程再试图写管道，其他进程从管道中移走数据之前写进程将一直阻塞。
> + <font color=red><strong>无名管道：</strong> 是一种半双工的通信方式，数据只能单向流动，只有亲缘关系的进程间使用</font>
>+ <font color=red><strong>命名管道：</strong>也是一种半双工的通信方式，在文件系统作为一个特殊的设备文件存在，但是它允许无亲缘关系的进程间通信。</font>
+ 信号量：信号量是一个计数器，不能传递复杂消息，只能用来同步，用来控制多个进程对共享资源的访问。它常作为一种锁的机制，防止进程间以及同一进程内的不同线程之间的同步作用。
+ 消息队列： 消息队列是由消息组成的链表，存放在内核中并由消息队列标识符标识，消息队列<font color=green>克服了信号传递消息少、管道只能承载无格式字节流以及缓冲区大小受限制等缺点。</font> 需要注意的是<font color=red>消息队列是创建文件的方式创建的，如果一个进程向某个消息队列写入数据之后，另外一个进程并没有取出数据，即使向消息队列中写数据的进程已经结束，保存在消息队列中的数据并没有消失（也就说是该类型通信是文件系统持续性）</font>
+ 信号：信号是一种比较复杂的通信方式，用于通知接收进程的某个事件已经发生。
+ 共享内存：只要首先创建一个共享内存区，多个进程都可以访问。<font color=red>内存共享是最快的IPC（进程通信）方式</font>它往往与其他进程通信机制（如信号量）配合使用，来实现进程间的同步和通信。
+ 套接字：套接字也是一种进程间通信机制，与其他的通信机制不同的是：他可以用于不同机器之间的进程通信。

#### 几种方式的比较：
+ 管道：速度慢，容量有限
+ 消息队列：容量受到系统的限制，且要注意第一读的时候，要考虑上一次没有读完数据的问题。
+ 信号量：不能传递复杂消息，只能用来同步
+ 共享内存：能够很容易控制容量，速度快，但要保持同步，比如一个进程在写的时候，另一个进程要注意读写的问题，相当于线程中的线程安全，当然，共享内存区同样可以用作线程间通讯，不过没这个必要，线程间本来就已经共享了一块内存的。



#### Unix  进程间共享信息的三种方式

![Alt 进程间共享信息的三种方式](./image/pro_com.jpg)
<strong>中间的两个进程共享是驻留在内核的某些消息，管道，System V消息队列和System V信号量也是。现在访问共享内消息的每次操作涉及到对内核的一次系统调用</strong>

IPC对象的持续性
========
![Alt IPC对象的持续性](./image/pro_com_2.jpg)
+ 随着进程持续的 (例如管道和FIFO这种对象)
+ 随着内核持续的 （例如system V的消息队列，信号量和共享内存）
+ 随着文件系统持续的 （比如 psoix 消息队列，信号量和共享内存）

总结
=======

####<strong><font color=red>在定义一个IPC对象的持续性时我们必须小心，例如管道内的数据是在内核维护的，但管道具备的随进程的持续性而并不是随内核的持续性；不论进程是否自动关闭管道，管里面的数据随着进程结束而被内核丢弃</font></strong>





